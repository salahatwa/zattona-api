(window["webpackJsonp"]=window["webpackJsonp"]||[]).push([["chunk-2d0b8b03"],{"306f":function(t,e,a){"use strict";a.r(e);var n=function(){var t=this,e=t.$createElement,a=t._self._c||e;return a("div",[a("a-row",{staticClass:"h-screen",attrs:{type:"flex",justify:"center",align:"middle"}},[a("a-col",{attrs:{xl:8,md:12,sm:20,xs:24}},[a("div",{staticClass:"card-container"},[a("a-card",{staticStyle:{"box-shadow":"0px 10px 20px 0px rgba(236, 236, 236, 0.86)"},attrs:{bordered:!1,title:"Genhub Setup Wizard"}},[a("a-steps",{attrs:{current:t.stepCurrent}},[a("a-step",{attrs:{title:"Blogger Info"}}),a("a-step",{attrs:{title:"Blog Info"}}),a("a-step",{attrs:{title:"Data import"}})],1),a("a-divider",{attrs:{dashed:""}}),a("a-form-model",{directives:[{name:"show",rawName:"v-show",value:0==t.stepCurrent,expression:"stepCurrent == 0"}],ref:"generalForm",attrs:{model:t.installation,rules:t.generalRules,layout:"horizontal"}},[a("a-form-model-item",{staticClass:"animated fadeInUp",attrs:{prop:"username"}},[a("a-input",{attrs:{placeholder:"username"},model:{value:t.installation.username,callback:function(e){t.$set(t.installation,"username",e)},expression:"installation.username"}},[a("a-icon",{staticStyle:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"user"},slot:"prefix"})],1)],1),a("a-form-model-item",{staticClass:"animated fadeInUp",style:{"animation-delay":"0.1s"},attrs:{prop:"nickname"}},[a("a-input",{attrs:{placeholder:"nickname"},model:{value:t.installation.nickname,callback:function(e){t.$set(t.installation,"nickname",e)},expression:"installation.nickname"}},[a("a-icon",{staticStyle:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"smile"},slot:"prefix"})],1)],1),a("a-form-model-item",{staticClass:"animated fadeInUp",style:{"animation-delay":"0.2s"},attrs:{prop:"email"}},[a("a-input",{attrs:{placeholder:"email"},model:{value:t.installation.email,callback:function(e){t.$set(t.installation,"email",e)},expression:"installation.email"}},[a("a-icon",{staticStyle:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"mail"},slot:"prefix"})],1)],1),a("a-form-model-item",{staticClass:"animated fadeInUp",style:{"animation-delay":"0.3s"},attrs:{prop:"password"}},[a("a-input",{attrs:{type:"password",placeholder:"User password (8-100 digits)"},model:{value:t.installation.password,callback:function(e){t.$set(t.installation,"password",e)},expression:"installation.password"}},[a("a-icon",{staticStyle:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1),a("a-form-model-item",{staticClass:"animated fadeInUp",style:{"animation-delay":"0.4s"},attrs:{prop:"confirmPassword"}},[a("a-input",{attrs:{type:"password",placeholder:"confirm password"},model:{value:t.installation.confirmPassword,callback:function(e){t.$set(t.installation,"confirmPassword",e)},expression:"installation.confirmPassword"}},[a("a-icon",{staticStyle:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"lock"},slot:"prefix"})],1)],1)],1),a("a-form-model",{directives:[{name:"show",rawName:"v-show",value:1==t.stepCurrent,expression:"stepCurrent == 1"}],ref:"blogForm",attrs:{layout:"horizontal",model:t.installation,rules:t.blogRules}},[a("a-form-model-item",{staticClass:"animated fadeInUp",attrs:{prop:"url"}},[a("a-input",{attrs:{placeholder:"Blog address"},model:{value:t.installation.url,callback:function(e){t.$set(t.installation,"url",e)},expression:"installation.url"}},[a("a-icon",{staticStyle:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"link"},slot:"prefix"})],1)],1),a("a-form-model-item",{staticClass:"animated fadeInUp",style:{"animation-delay":"0.2s"},attrs:{prop:"title"}},[a("a-input",{attrs:{placeholder:"Blog title"},model:{value:t.installation.title,callback:function(e){t.$set(t.installation,"title",e)},expression:"installation.title"}},[a("a-icon",{staticStyle:{color:"rgba(0,0,0,.25)"},attrs:{slot:"prefix",type:"book"},slot:"prefix"})],1)],1)],1),a("div",{directives:[{name:"show",rawName:"v-show",value:2==t.stepCurrent,expression:"stepCurrent == 2"}]},[a("a-alert",{staticStyle:{"margin-bottom":"1rem"},attrs:{message:"If there is a data import requirement, please click on and select the previously exported file. It should be noted that not all data will be imported, and the data in the initialization form will overwrite the data you imported.",type:"info"}}),a("FilePondUpload",{ref:"upload",attrs:{name:"file",accept:"application/json",label:"Drag or Click on to select the data file, please confirm whether it is the file exported from the Halo background.",multiple:!1,uploadHandler:t.handleMigrationUpload,loadOptions:!1}})],1),a("a-row",{staticClass:"install-action",staticStyle:{"margin-top":"1rem"},attrs:{type:"flex",justify:"space-between"}},[a("div",[0!=t.stepCurrent?a("a-button",{staticClass:"previus-button",staticStyle:{"margin-right":"1rem"},on:{click:function(e){t.stepCurrent--}}},[t._v("Previous")]):t._e(),2!=t.stepCurrent?a("a-button",{attrs:{type:"primary"},on:{click:t.handleNextStep}},[t._v("Next step")]):t._e()],1),2==t.stepCurrent?a("a-button",{attrs:{type:"primary",icon:"upload",loading:t.installing},on:{click:t.handleInstall}},[t._v("Installation")]):t._e()],1)],1)],1)])],1)],1)},r=[],s=(a("8e6e"),a("ac6a"),a("456d"),a("96cf"),a("1da1")),i=a("ade3"),o=a("50fc"),l=a("9efd"),c="/api/admin/migrations",p={migrate:function(t){return Object(l["a"])({url:"".concat(c,"/halo"),data:t,method:"post"})}},d=p,m=a("2f62");function u(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var n=Object.getOwnPropertySymbols(t);e&&(n=n.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,n)}return a}function g(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?u(Object(a),!0).forEach((function(e){Object(i["a"])(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):u(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}var f={data:function(){var t=this,e=function(e,a,n){a!==t.installation.password?n(new Error("Confirm the password is consistent with the entered password")):n()};return{installation:{},stepCurrent:0,migrationData:null,installing:!1,generalRules:{username:[{required:!0,message:"* Username cannot be empty",trigger:["change"]},{max:50,message:"* The character length of the user name must not exceed 50",trigger:["change"]}],nickname:[{required:!0,message:"* User nickname cannot be empty",trigger:["change"]},{max:255,message:"* The character length of the user nickname must not exceed 255",trigger:["change"]}],email:[{required:!0,message:"* Email address cannot be empty",trigger:["change"]},{max:127,message:"* The character length of the email address must not exceed 127",trigger:["change"]},{pattern:/\w[-\w.+]*@([A-Za-z0-9][-A-Za-z0-9]+\.)+[A-Za-z]{2,14}/g,message:"* The format of the email address is not correct",trigger:["change"]}],password:[{required:!0,message:"* Password cannot be empty",trigger:["change"]},{min:8,max:100,message:"* The character length of the password must be between 8-100",trigger:["change"]}],confirmPassword:[{required:!0,message:"* Confirm password cannot be empty",trigger:["change"]},{validator:e,trigger:["change"]}]},blogRules:{url:[{required:!0,message:"* Blog address cannot be empty",trigger:["change"]}],title:[{required:!0,message:"* Blog title cannot be empty",trigger:["change"]}]}}},beforeMount:function(){this.handleVerifyIsInstall(),this.$set(this.installation,"url",window.location.protocol+"//"+window.location.host)},methods:g(g({},Object(m["b"])(["installCleanToken"])),{},{handleVerifyIsInstall:function(){var t=Object(s["a"])(regeneratorRuntime.mark((function t(){var e=this;return regeneratorRuntime.wrap((function(t){while(1)switch(t.prev=t.next){case 0:return t.next=2,o["a"].isInstalled().then((function(t){t.data.data&&e.$router.push({name:"Login"})}));case 2:case"end":return t.stop()}}),t)})));function e(){return t.apply(this,arguments)}return e}(),handleNextStep:function(){var t=this;0===this.stepCurrent?this.$refs.generalForm.validate((function(e){if(!e)return!1;t.stepCurrent++})):1===this.stepCurrent&&this.$refs.blogForm.validate((function(e){if(!e)return!1;t.stepCurrent++}))},handleMigrationUpload:function(t){var e=this;return this.$log.debug("Selected data",t),this.migrationData=t,new Promise((function(t,a){e.$log.debug("Handle uploading"),t()}))},install:function(){var t=this;this.installCleanToken(this.installation).then((function(e){t.$log.debug("Installation response",e),t.$message.success("Installation success！"),setTimeout((function(){t.$router.push({name:"Login"})}),200)})).finally((function(){setTimeout((function(){t.installing=!1}),400)}))},handleInstall:function(){var t=this;if(this.installing=!0,this.migrationData){var e=this.$message.loading("Data importing...",0);d.migrate(this.migrationData).then((function(e){t.$log.debug("Migrated successfullly"),t.$message.success("Data import success!"),t.install()})).finally((function(){e()}))}else this.install()}})},h=f,b=a("2877"),y=Object(b["a"])(h,n,r,!1,null,null,null);e["default"]=y.exports}}]);